<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Tispy!</title>
</head>

<body>
  <button>Get Tispy</button>

  <div id="drink-list"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script type="text/javascript">
    var qText = "vodka";
    $("button").on("click", function() {
      event.preventDefault();
      var qURL = "http://www.thecocktaildb.com/api/json/v1/1/filter.php?i=" + qText;
      console.log(qURL);
      $.get(qURL).done(function(response) {
        var results = response.drinks;
        var drinkIds = [];
        for (i = 0; i < results.length; i++) {
          drinkIds.push(results[i].idDrink);
        }
        console.log(drinkIds);
        document.getElementById("drink-list").InnerHTML = "";
        if (drinkIds.length > 0) {
          for (j = 0; j < drinkIds.length; j++) {
            var qURL2 = "http://www.thecocktaildb.com/api/json/v1/1/lookup.php?i=" + drinkIds[j];
            $.get(qURL2).done(function(response) {
              var dHtml = "";
              var results2 = response.drinks[0];
              console.log(results2);
              //dHtml += '<div class="search-result">\n' +
              dHtml += '<img src="' + results2.strDrinkThumb + '" style="float: left; width: 120px; height: 120px;">\n' +
                        '<strong>' + results2.strDrink + '</strong>\n';
              for (k = 1; k <= 15; k++) {
                if (!results2["strIngredient" + k] == null) {
                  if (results2["strIngredient" + k].length > 0) {
                    dHtml += "<p>";
                    if (results2["strMeasure" + k].length > 0) {
                      dHtml += results2["strMeasure" + k] + " ";
                    }
                    dHtml += results2["strIngredient" + k] + "</p>\n";
                  }
                }
              }
              dHtml += '<p><strong>Ingredients</strong>: ' + results2.strInstructions + '</p>\n';
              if (results2.strGlass.length > 0) {
                dHtml += '<p><strong>Ingredients</strong>: ' + results2.strGlass + '</p>\n';
              }
              // MISSING INGREDIENTS
              //dHtml += '</div>\n';
              var newDiv = document.createElement('div');
              newDiv.innerHTML = dHtml;
              document.getElementById("drink-list").appendChild(newDiv);
              //document.getElementById("drink-list").innerHTML = dHtml;
              //console.log(dHtml);
            });
          }
        }
      });
    });
  </script>
</body>

</html>
